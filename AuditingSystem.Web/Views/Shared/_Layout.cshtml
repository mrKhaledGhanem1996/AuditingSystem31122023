@using Microsoft.AspNetCore.Http
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor

<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Onyx Admin</title>
    <!-- base:css -->
    <link rel="stylesheet" href="~/vendors/mdi/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="~/vendors/css/vendor.bundle.base.css">
    <!-- endinject -->
    <!-- plugin css for this page -->
    <!-- End plugin css for this page -->
    <!-- inject:css -->
    <link rel="stylesheet" href="~/css/style.css">
    <!-- endinject -->
    <link rel="shortcut icon" href="~/images/favicon.png" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdn.ckeditor.com/4.16.2/full-all/ckeditor.js"></script>

    <style>
        .fa-solid {
            font-size: 18px;
        }

        .fa-trash {
            color: #e94848;
        }

        label.error {
            color: #ff0000;
        }

        input.error, select.error {
            border: 1px solid #ff0000;
        }

        .error {
            color: red;
        }

        .input-validation-error {
            border: 1px solid red;
        }

    </style>
    <style>
        table {
            overflow: hidden;
        }
        /*
                .resizer {
            position: absolute;
            top: 0;
            right: -8px;
            bottom: 0;
            left: auto;
            width: 16px;
            cursor: col-resize;
        } */
    </style>
</head>
<body>
    <div class="container-scroller d-flex">
        <!-- partial:./partials/_sidebar.html -->
        <nav class="sidebar sidebar-offcanvas" id="sidebar">
            <ul class="nav">
                <li class="nav-item sidebar-category" style="">
                    <p>Navigation</p>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">
                        <i class="mdi mdi-view-quilt menu-icon"></i>
                        <span class="menu-title">Dashboard</span>
                    </a>
                </li>
                <li class="nav-item sidebar-category" style="">
                    <p>Components</p>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="collapse" href="#Lockups" aria-expanded="false" aria-controls="Lockups">
                        <i class="fa-solid fa-star" style="margin-right: 6px"></i>
                        <span class="menu-title">Lockups</span>
                        <i class="menu-arrow"></i>
                    </a>
                    <div class="collapse" id="Lockups">
                        <ul class="nav flex-column sub-menu">
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="ControlEffectivenessc">Control Effectiveness</a></li>
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="ControlFrequencyss">ControlFrequency</a></li>
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="ControlProcesses">Control Processes</a></li>
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="ControlTypes">Control Types</a></li>
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="RiskCategorysscs">Risk Category</a></li>
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="RiskImpactes">Risk Impact</a></li>
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="RiskLikehoodes">Risk Likehoode</a></li>
                        </ul>
                    </div>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="collapse" href="#SetUP" aria-expanded="false" aria-controls="SetUP">
                        <i class="fa-solid fa-star" style="margin-right: 6px"></i>
                        <span class="menu-title">Set UP</span>
                        <i class="menu-arrow"></i>
                    </a>
                    <div class="collapse" id="SetUP">
                        <ul class="nav flex-column sub-menu">
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="Year">Years</a></li>
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="User">Users</a></li>
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="Role">Roles</a></li>
                        </ul>
                    </div>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="collapse" href="#AuditProcess" aria-expanded="false" aria-controls="AuditProcess">
                        <i class="fa-solid fa-microchip" style="margin-right: 6px"></i>
                        <span class="menu-title">Audit Process</span>
                        <i class="menu-arrow"></i>
                    </a>
                    <div class="collapse" id="AuditProcess">
                        <ul class="nav flex-column sub-menu">
                            <li class="nav-item"> <a class="nav-link" href="#">Audit Universe</a></li>
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="Industry">Industry</a></li>
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="Company">Companies</a></li>
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="Department">Departments</a></li>
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="Function">Functions</a></li>
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="Activity">Activities</a></li>
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="Objective">Objectives</a></li>
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="Task">Tasks</a></li>
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="Practice">Practices</a></li>
                        </ul>
                    </div>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="collapse" href="#RiskAssessments" aria-expanded="false" aria-controls="RiskAssessments">
                        <i class="fa-solid fa-asterisk" style="margin-right: 6px"></i>
                        <span class="menu-title">Risk Assessments</span>
                        <i class="menu-arrow"></i>
                    </a>
                    <div class="collapse" id="RiskAssessments">
                        <ul class="nav flex-column sub-menu">
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="RiskIdentification">Risk Identification</a></li>
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="Control">Controls</a></li>
                            <li class="nav-item"> <a class="nav-link" asp-action="Index" asp-controller="RiskAssessment">Risk Assessment</a></li>
                        </ul>
                    </div>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="collapse" href="#AuditPlans" aria-expanded="false" aria-controls="AuditPlans">
                        <i class="fas fa-check-circle" style="margin-right: 6px"></i>
                        <span class="menu-title">Audit Plans</span>
                        <i class="menu-arrow"></i>
                    </a>
                    <div class="collapse" id="AuditPlans">
                        <ul class="nav flex-column sub-menu">
                            <li class="nav-item"> <a class="nav-link" href="#">Audit Resources</a></li>
                            <li class="nav-item"> <a class="nav-link" href="#">Budget</a></li>
                            <li class="nav-item"> <a class="nav-link" href="#">Draft Plan</a></li>
                            <li class="nav-item"> <a class="nav-link" href="#">Final Plan</a></li>
                            <li class="nav-item"> <a class="nav-link" href="#">Audit Field Works</a></li>
                            <li class="nav-item"> <a class="nav-link" href="#">Audit Engagement</a></li>
                            <li class="nav-item"> <a class="nav-link" href="#">IA Meetings</a></li>
                            <li class="nav-item"> <a class="nav-link" href="#">Engagement Lettr</a></li>
                            <li class="nav-item"> <a class="nav-link" href="#">Process walkthrough</a></li>
                            <li class="nav-item"> <a class="nav-link" href="#">Audit Programs</a></li>
                            <li class="nav-item"> <a class="nav-link" href="#">List of Information</a></li>
                            <li class="nav-item"> <a class="nav-link" href="#">Audit Field Tests</a></li>
                            <li class="nav-item"> <a class="nav-link" href="#">Audit Progress</a></li>
                            <li class="nav-item"> <a class="nav-link" href="#">Sampling</a></li>
                            <li class="nav-item"> <a class="nav-link" href="#">Observations</a></li>
                        </ul>
                    </div>
                </li>
            </ul>
        </nav>
        <!-- partial -->
        <div class="container-fluid page-body-wrapper">
            <!-- partial:./partials/_navbar.html -->
            <nav class="navbar col-lg-12 col-12 px-0 py-0 py-lg-4 d-flex flex-row" style="    z-index: 99;">
                <div class="navbar-menu-wrapper d-flex align-items-center justify-content-end">
                    <button class="navbar-toggler navbar-toggler align-self-center" type="button" data-toggle="minimize">
                        <span class="mdi mdi-menu"></span>
                    </button>
                    <div class="navbar-brand-wrapper">
                        <a class="navbar-brand brand-logo" href="index.html"><img style="width:50px" src="~/images/logo.png" alt="logo" /> ONYX</a>
                        <a class="navbar-brand brand-logo-mini" href="index.html"><img src="~/images/logo-mini.svg" alt="logo" /></a>
                    </div>
                    <h4 class="font-weight-bold mb-0 d-none d-md-block mt-1">
                        Welcome back, @HttpContextAccessor.HttpContext.Session.GetString("UserName")
                    </h4>
                    <ul class="navbar-nav navbar-nav-right">
                        <li class="nav-item">
                            <h4 class="mb-0 font-weight-bold d-none d-xl-block">@DateTime.Now.ToString("yyyy-MM-dd, HH:mm tt")</h4>
                        </li>
                        <li class="nav-item dropdown me-1">
                            <a class="nav-link count-indicator dropdown-toggle d-flex justify-content-center align-items-center" id="messageDropdown" href="#" data-bs-toggle="dropdown">
                                <i class="mdi mdi-calendar mx-0"></i>
                                <span class="count bg-info">2</span>
                            </a>
                            <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="messageDropdown">
                                <p class="mb-0 font-weight-normal float-left dropdown-header">Messages</p>
                                <a class="dropdown-item preview-item">
                                    <div class="preview-thumbnail">
                                        <img src="~/images/faces/face4.jpg" alt="image" class="profile-pic">
                                    </div>
                                    <div class="preview-item-content flex-grow">
                                        <h6 class="preview-subject ellipsis font-weight-normal">
                                            David Grey
                                        </h6>
                                        <p class="font-weight-light small-text text-muted mb-0">
                                            The meeting is cancelled
                                        </p>
                                    </div>
                                </a>
                                <a class="dropdown-item preview-item">
                                    <div class="preview-thumbnail">
                                        <img src="~/images/faces/face2.jpg" alt="image" class="profile-pic">
                                    </div>
                                    <div class="preview-item-content flex-grow">
                                        <h6 class="preview-subject ellipsis font-weight-normal">
                                            Tim Cook
                                        </h6>
                                        <p class="font-weight-light small-text text-muted mb-0">
                                            New product launch
                                        </p>
                                    </div>
                                </a>
                                <a class="dropdown-item preview-item">
                                    <div class="preview-thumbnail">
                                        <img src="~/images/faces/face3.jpg" alt="image" class="profile-pic">
                                    </div>
                                    <div class="preview-item-content flex-grow">
                                        <h6 class="preview-subject ellipsis font-weight-normal">
                                            Johnson
                                        </h6>
                                        <p class="font-weight-light small-text text-muted mb-0">
                                            Upcoming board meeting
                                        </p>
                                    </div>
                                </a>
                            </div>
                        </li>
                        <li class="nav-item dropdown me-2">
                            <a class="nav-link count-indicator dropdown-toggle d-flex align-items-center justify-content-center" id="notificationDropdown" href="#" data-bs-toggle="dropdown">
                                <i class="mdi mdi-email-open mx-0"></i>
                                <span class="count bg-danger">1</span>
                            </a>
                            <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="notificationDropdown">
                                <p class="mb-0 font-weight-normal float-left dropdown-header">Notifications</p>
                                <a class="dropdown-item preview-item">
                                    <div class="preview-thumbnail">
                                        <div class="preview-icon bg-success">
                                            <i class="mdi mdi-information mx-0"></i>
                                        </div>
                                    </div>
                                    <div class="preview-item-content">
                                        <h6 class="preview-subject font-weight-normal">Application Error</h6>
                                        <p class="font-weight-light small-text mb-0 text-muted">
                                            Just now
                                        </p>
                                    </div>
                                </a>
                                <a class="dropdown-item preview-item">
                                    <div class="preview-thumbnail">
                                        <div class="preview-icon bg-warning">
                                            <i class="mdi mdi-settings mx-0"></i>
                                        </div>
                                    </div>
                                    <div class="preview-item-content">
                                        <h6 class="preview-subject font-weight-normal">Settings</h6>
                                        <p class="font-weight-light small-text mb-0 text-muted">
                                            Private message
                                        </p>
                                    </div>
                                </a>
                                <a class="dropdown-item preview-item">
                                    <div class="preview-thumbnail">
                                        <div class="preview-icon bg-info">
                                            <i class="mdi mdi-account-box mx-0"></i>
                                        </div>
                                    </div>
                                    <div class="preview-item-content">
                                        <h6 class="preview-subject font-weight-normal">New user registration</h6>
                                        <p class="font-weight-light small-text mb-0 text-muted">
                                            2 days ago
                                        </p>
                                    </div>
                                </a>
                            </div>
                        </li>
                    </ul>
                    <button style="position:absolute;left:0;margin:-7px;" class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button" data-toggle="offcanvas">
                        <span class="mdi mdi-menu"></span>
                    </button>
                </div>
                <div class="navbar-menu-wrapper navbar-search-wrapper d-none d-lg-flex align-items-center">
                    <ul class="navbar-nav mr-lg-2" id="SearchList">
                        <li class="nav-item nav-search d-none d-lg-block">
                            <div class="input-group">
                                <input id="Search" type="text" class="form-control" placeholder="Search Here..." aria-label="search" aria-describedby="search">
                            </div>
                        </li>
                    </ul>
                    <ul class="navbar-nav navbar-nav-right">
                        <li class="nav-item nav-profile dropdown">
                            <a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown" id="profileDropdown">
                                
                                <span style="font-size:18px;" class="nav-profile-name">@HttpContextAccessor.HttpContext.Session.GetString("UserName")</span>
                            </a>
                            <div class="dropdown-menu dropdown-menu-right navbar-dropdown" aria-labelledby="profileDropdown">
                                <a class="dropdown-item">
                                    <i class="mdi mdi-settings text-primary"></i>
                                    Settings
                                </a>
                                <a asp-action="Logout" asp-controller="Account" class="dropdown-item">
                                    <i class="mdi mdi-logout text-primary"></i>
                                    Logout
                                </a>
                            </div>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link icon-link">
                                <i class="mdi mdi-plus-circle-outline"></i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link icon-link">
                                <i class="mdi mdi-web"></i>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link icon-link">
                                <i class="mdi mdi-clock-outline"></i>
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
            <!-- partial -->
            <div class="main-panel">
                <div class="content-wrapper">
                    @RenderBody()

                    <!-- row end -->
                </div>
                <!-- content-wrapper ends -->
                <!-- partial:./partials/_footer.html -->
                <footer class="footer">
                    <div class="card">
                        <div class="card-body">
                            <div class="d-sm-flex justify-content-center justify-content-sm-between py-2">
                                <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">Copyright © <a href="#" target="_blank">ONYX </a>@DateTime.Now.Year</span>
                            </div>
                        </div>
                    </div>
                </footer>
                <!-- partial -->
            </div>
            <!-- main-panel ends -->
        </div>
        <!-- page-body-wrapper ends -->
    </div>
    <!-- container-scroller -->
    <!-- base:js -->
    <script src="~/vendors/js/vendor.bundle.base.js"></script>
    <!-- endinject -->
    <!-- Plugin js for this page-->
    <script src="~/vendors/chart.js/Chart.min.js"></script>
    <script src="~/js/jquery.cookie.js" type="text/javascript"></script>
    <!-- End plugin js for this page-->
    <!-- inject:js -->
    <script src="~/js/off-canvas.js"></script>
    <script src="~/js/hoverable-collapse.js"></script>
    <script src="~/js/template.js"></script>
    <!-- endinject -->
    <!-- plugin js for this page -->
    <script src="~/js/jquery.cookie.js" type="text/javascript"></script>
    <!-- End plugin js for this page -->
    <!-- Custom js for this page-->
    <script src="~/js/dashboard.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <!-- End custom js for this page-->
    @RenderSection("Scripts", required: false)
    

    <script>
        $(document).ready(function () {
            CKEDITOR.replace("Description");
            CKEDITOR.replace("RiskRatingRationalization");

            // Add keyup event to the search input
            $("#Search").keyup(function () {
                var searchText = $(this).val().toLowerCase();

                // Loop through each row in the table body
                $("#tableList tbody tr").each(function () {
                    var rowText = $(this).text().toLowerCase();

                    // Show or hide the row based on the search text
                    if (rowText.includes(searchText)) {
                        $(this).show();
                    } else {
                        $(this).hide();
                    }
                });
            });



        });


    </script>
    <script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/jquery.validate.min.js"></script>
    <script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/additional-methods.min.js"></script>
    

    <script>
        $(document).on("click", "#btnDelete", function () {
            var btnId = $(this);
            var table = $('#tableList');
            if (confirm("Are you sure to delete it?")) {
                $.ajax({
                    url: '/api/@ViewData["DeleteTitle"]/' + btnId.attr("data-actions-id"),
                    method: 'DELETE',
                    dataType: 'json',
                    contentType: 'application/json',
                    success: function (response) {
                        alert("The Delete is Successfully");
                        btnId.parents("#tr").remove();
                    },
                    error: function (error) {
                        alert("The Delete is Successfully");
                        btnId.parents("#tr").remove();
                        // alert("Error Details → " + error.responseText);
                        // if (error.responseJSON && error.responseJSON.errors) {
                        //     $.each(error.responseJSON.errors, function (key, value) {
                        //         $("#" + key).siblings(".text-danger").text(value);
                        //     });
                        // }
                    }
                });
            }
        });

        $(document).ready(function () {
            $("td,th")
                .css({
                    /* required to allow resizer embedding */
                    position: "relative"
                })
                /* check .resizer CSS */
                .prepend("<div class='resizer'></div>")
                .resizable({
                    resizeHeight: false,
                    // we use the column as handle and filter
                    // by the contained .resizer element
                    handleSelector: "",
                    onDragStart: function (e, $el, opt) {
                        // only drag resizer
                        if (!$(e.target).hasClass("resizer"))
                            return false;
                        return true;
                    }
                });
        });
    </script>
@*     <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.js"></script>*@    
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://cdn.rawgit.com/dobtco/jquery-resizable-columns/v1.0.9/jquery.resizableColumns.min.js"></script>


</body>

</html>